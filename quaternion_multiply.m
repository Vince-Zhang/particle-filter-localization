function Q = quaternion_multiply(q1,q2)
Q(:,1) = q1(:,1).*q2(:,1) - sum(q1(:,2:4).*q2(:,2:4),2);
Q(:,2) = q1(:,2).*q2(:,1) + q1(:,3).*q2(:,4) + q1(:,1).*q2(:,2) - q1(:,4).*q2(:,3);
Q(:,3) = q1(:,1).*q2(:,3) + q1(:,4).*q2(:,2) + q1(:,3).*q2(:,1) - q1(:,2).*q2(:,4);
Q(:,4) = q1(:,1).*q2(:,4) + q2(:,1).*q1(:,4) + q1(:,2).*q2(:,3) - q1(:,3).*q2(:,2);